<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanji N5 Master - Premium AI Trainer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
        }

        body {
            font-family: 'Plus Jakarta Sans', 'Noto Sans JP', sans-serif;
            background: radial-gradient(circle at top right, #eef2ff, #f8fafc);
            color: #1e293b;
        }

        /* Hiệu ứng thẻ nổi khối */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.7);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.04), 0 8px 10px -6px rgba(0, 0, 0, 0.04);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .glass-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.08), 0 10px 10px -6px rgba(0, 0, 0, 0.05);
        }

        .japanese-text {
            font-family: 'Noto Sans JP', sans-serif;
        }

        /* Button Effects */
        .btn-modern {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .btn-modern:hover {
            transform: translateY(-2px) scale(1.02);
        }

        .btn-modern:active {
            transform: translateY(0) scale(0.95);
        }

        /* Hiệu ứng ánh kim cho button chính */
        .shimmer-effect::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            transition: 0.5s;
            animation: shimmer-btn 3s infinite;
        }

        @keyframes shimmer-btn {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .hidden-content {
            filter: blur(12px);
            opacity: 0.3;
            user-select: none;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .revealed {
            filter: blur(0);
            opacity: 1;
        }

        /* Loading animation */
        .loading-shimmer {
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite linear;
        }

        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Progress bar animation */
        .progress-glow {
            box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
        }

        .kanji-badge {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 py-4 px-6 sticky top-0 z-20">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-indigo-600 text-white w-10 h-10 flex items-center justify-center rounded-xl shadow-lg shadow-indigo-200 animate-pulse">
                    <i class="fas fa-brain text-lg"></i>
                </div>
                <div>
                    <h1 class="text-xl font-extrabold text-slate-800 tracking-tight">Kanji <span class="text-indigo-600">Pro</span></h1>
                    <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">N5 Context Trainer</p>
                </div>
            </div>
            <div class="flex flex-col items-end gap-1">
                <div class="flex items-center gap-3 text-sm font-bold text-slate-600">
                    <span id="progress-text">Đã học: 0 câu</span>
                    <i class="fas fa-fire text-orange-500"></i>
                </div>
                <div class="w-40 h-2 bg-slate-100 rounded-full overflow-hidden border border-slate-200">
                    <div id="progress-bar" class="h-full bg-indigo-600 progress-glow transition-all duration-700 ease-out" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow p-4 md:p-8">
        <div class="max-w-3xl mx-auto">
            
            <!-- Question Card -->
            <div id="game-card" class="glass-card rounded-3xl p-8 mb-8 border border-white">
                <div class="flex items-start justify-between mb-8">
                    <div>
                        <span class="bg-indigo-50 text-indigo-600 text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-tighter border border-indigo-100">Cấp độ N5</span>
                        <h2 id="vietnamese-sentence" class="text-2xl md:text-4xl font-extrabold text-slate-800 mt-4 leading-tight">
                            Nhấn Bắt đầu để học Kanji cùng Roi san nhéee!
                        </h2>
                    </div>
                </div>

                <!-- Answer Area -->
                <div class="space-y-6">
                    <div class="bg-slate-50/50 rounded-2xl p-6 border border-slate-100">
                        <div class="mb-6">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-2">
                                <i class="fas fa-volume-up text-indigo-400"></i> Cách đọc (Hiragana)
                            </label>
                            <p id="hiragana-text" class="japanese-text text-xl text-slate-500 font-medium hidden-content">
                                ...
                            </p>
                        </div>
                        <div>
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 mb-2">
                                <i class="fas fa-pen-nib text-indigo-400"></i> Đáp án Kanji
                            </label>
                            <div id="kanji-text" class="japanese-text text-4xl md:text-5xl font-bold text-indigo-950 hidden-content leading-relaxed">
                                ...
                            </div>
                        </div>
                    </div>

                    <!-- Main Buttons -->
                    <div class="flex flex-col sm:flex-row gap-4" id="action-buttons">
                        <button id="btn-hint" disabled class="btn-modern disabled:opacity-50 flex-1 bg-white border-2 border-slate-200 hover:border-indigo-400 text-slate-700 font-bold py-4 px-6 rounded-2xl flex items-center justify-center gap-3">
                            <i class="far fa-lightbulb text-amber-500"></i> Hiện Gợi Ý
                        </button>
                        <button id="btn-reveal" disabled class="btn-modern shimmer-effect disabled:opacity-50 flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-2xl shadow-xl shadow-indigo-200 flex items-center justify-center gap-3">
                            <i class="fas fa-eye"></i> Xem Đáp Án
                        </button>
                    </div>
                </div>
            </div>

            <!-- Explanation Section -->
            <div id="explanation-box" class="hidden transform transition-all duration-500">
                <div class="bg-white rounded-3xl shadow-xl border border-slate-100 overflow-hidden">
                    <div class="bg-indigo-50/50 px-8 py-5 border-b border-indigo-100 flex justify-between items-center">
                        <h3 class="font-bold text-indigo-900 flex items-center gap-2">
                            <i class="fas fa-sparkles text-indigo-500"></i> Chi tiết các chữ Kanji
                        </h3>
                        <span class="text-[10px] font-bold text-indigo-400 bg-white px-2 py-1 rounded border border-indigo-100">PHÂN TÍCH TỪ VỰNG</span>
                    </div>
                    <div id="kanji-details" class="p-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Kanji cards -->
                    </div>
                    <div class="p-8 pt-0">
                        <button id="btn-next" class="btn-modern w-full bg-emerald-500 hover:bg-emerald-600 text-white font-black py-5 px-6 rounded-2xl shadow-lg shadow-emerald-100 flex items-center justify-center gap-3 text-lg">
                            TIẾP TỤC HỌC <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Initial Start State -->
            <div id="start-container" class="text-center py-10">
                 <button id="btn-start" class="btn-modern shimmer-effect bg-indigo-600 text-white font-black py-5 px-16 rounded-3xl shadow-2xl shadow-indigo-200 text-xl tracking-tight">
                    BẮT ĐẦU NGAY
                 </button>
                 <p class="text-slate-400 text-xs mt-6 font-medium">Hệ thống AI sẽ tự động tạo lộ trình câu hỏi cho bạn</p>
            </div>

        </div>
    </main>

    <footer class="py-10 text-center">
        <div class="flex justify-center gap-4 mb-4">
            <a href="#" class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-400 hover:text-indigo-600 transition-colors"><i class="fab fa-facebook-f text-xs"></i></a>
            <a href="#" class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-400 hover:text-indigo-600 transition-colors"><i class="fab fa-github text-xs"></i></a>
        </div>
        <p class="text-slate-400 text-[11px] font-bold uppercase tracking-[0.2em]"> Phát triển bởi Lợi Lê
    </footer>

    <!-- Feedback Toast -->
    <div id="message-box" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-slate-900/90 backdrop-blur text-white px-8 py-4 rounded-2xl shadow-2xl opacity-0 transition-all duration-300 pointer-events-none z-50 flex items-center gap-3 border border-white/10">
        <i class="fas fa-info-circle text-indigo-400"></i>
        <span class="font-medium">Thông báo...</span>
    </div>

    <script>
        const apiKey = "";
        
        const n5KanjiList = [
            "一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "百", "千", "万", "円", "口", "目", "耳", "手", "足", "力",
            "人", "子", "女", "男", "父", "母", "先", "生", "学", "校", "友", "本", "日", "月", "火", "水", "木", "金", "土", "年",
            "今", "何", "前", "後", "午", "中", "外", "右", "左", "上", "下", "山", "川", "田", "天", "気", "雨", "花", "国", "会",
            "社", "店", "駅", "道", "大", "小", "長", "高", "新", "古", "多", "少", "早", "白", "北", "南", "東", "西", "間", "半",
            "食", "飲", "見", "聞", "書", "読", "話", "買", "行", "来", "出", "入", "休"
        ];

        let countCompleted = 0;
        let isGenerating = false;

        const viText = document.getElementById('vietnamese-sentence');
        const hiraText = document.getElementById('hiragana-text');
        const kanjiText = document.getElementById('kanji-text');
        const kanjiDetails = document.getElementById('kanji-details');
        const explanationBox = document.getElementById('explanation-box');
        const btnHint = document.getElementById('btn-hint');
        const btnReveal = document.getElementById('btn-reveal');
        const btnNext = document.getElementById('btn-next');
        const btnStart = document.getElementById('btn-start');
        const startContainer = document.getElementById('start-container');
        const progressText = document.getElementById('progress-text');
        const progressBar = document.getElementById('progress-bar');
        const messageBox = document.getElementById('message-box');

        async function fetchAIQuestion() {
            if (isGenerating) return;
            isGenerating = true;
            
            // Loading state UI
            viText.innerHTML = '<div class="h-10 w-full loading-shimmer rounded-xl"></div>';
            hiraText.innerHTML = '<div class="h-6 w-3/4 loading-shimmer rounded-lg mt-2"></div>';
            kanjiText.innerHTML = '<div class="h-16 w-full loading-shimmer rounded-xl mt-4"></div>';
            
            explanationBox.classList.add('hidden');
            btnHint.disabled = true;
            btnReveal.disabled = true;

            const randomKanji = n5KanjiList[Math.floor(Math.random() * n5KanjiList.length)];
            
            const systemPrompt = `Bạn là chuyên gia dạy tiếng Nhật. Hãy tạo 1 câu hỏi luyện tập Kanji N5.
            Yêu cầu trả về định dạng JSON:
            {
                "vi": "Câu tiếng Việt ngắn gọn",
                "ja": "Câu tiếng Nhật tương ứng, phần Kanji bao quanh bởi <span>",
                "hira": "Cách đọc Hiragana",
                "kanji": [
                    { "char": "Kanji", "hanviet": "Âm Hán Việt", "mean": "Nghĩa", "on": "Onyomi", "kun": "Kunyomi" }
                ]
            }
            Tập trung vào: ${randomKanji}.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Tạo ví dụ cho chữ ${randomKanji}` }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                const data = await response.json();
                const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                const quiz = JSON.parse(resultText);
                
                renderQuestion(quiz);
            } catch (error) {
                viText.innerText = "Có lỗi xảy ra. Hãy thử nhấn nút Tiếp theo.";
                console.error(error);
            } finally {
                isGenerating = false;
                btnHint.disabled = false;
                btnReveal.disabled = false;
            }
        }

        function renderQuestion(data) {
            viText.innerText = data.vi;
            hiraText.innerText = data.hira;
            kanjiText.innerHTML = data.ja;
            
            hiraText.classList.remove('revealed');
            kanjiText.classList.remove('revealed');
            
            kanjiDetails.innerHTML = '';
            data.kanji.forEach(k => {
                const div = document.createElement('div');
                div.className = "p-5 border-2 border-slate-50 rounded-2xl bg-slate-50/50 hover:bg-white hover:border-indigo-100 transition-all group";
                div.innerHTML = `
                    <div class="flex items-center gap-4 mb-4">
                        <div class="w-14 h-14 bg-white rounded-xl shadow-sm flex items-center justify-center text-3xl font-bold text-indigo-600 japanese-text group-hover:scale-110 transition-transform">
                            ${k.char}
                        </div>
                        <div>
                            <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Hán Việt</p>
                            <p class="font-extrabold text-slate-800 text-lg">${k.hanviet}</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span class="text-slate-400 font-medium">Nghĩa:</span>
                            <span class="text-slate-700 font-bold">${k.mean}</span>
                        </div>
                        <div class="pt-2 border-t border-slate-200/50 space-y-1">
                            <p class="text-xs"><span class="text-slate-400">On:</span> <span class="text-indigo-500 font-mono">${k.on}</span></p>
                            <p class="text-xs"><span class="text-slate-400">Kun:</span> <span class="text-emerald-500 font-mono">${k.kun}</span></p>
                        </div>
                    </div>
                `;
                kanjiDetails.appendChild(div);
            });
        }

        function showMessage(msg) {
            messageBox.querySelector('span').innerText = msg;
            messageBox.classList.remove('opacity-0', 'translate-y-4');
            messageBox.classList.add('opacity-100', '-translate-y-2');
            setTimeout(() => {
                messageBox.classList.add('opacity-0', 'translate-y-4');
                messageBox.classList.remove('opacity-100', '-translate-y-2');
            }, 2500);
        }

        btnHint.addEventListener('click', () => {
            hiraText.classList.add('revealed');
            showMessage("Đã hiển thị gợi ý phiên âm!");
        });

        btnReveal.addEventListener('click', () => {
            hiraText.classList.add('revealed');
            kanjiText.classList.add('revealed');
            explanationBox.classList.remove('hidden');
            showMessage("Tuyệt vời! Hãy xem chi tiết ý nghĩa.");
        });

        btnNext.addEventListener('click', () => {
            countCompleted++;
            progressText.innerText = `Đã học: ${countCompleted} câu`;
            progressBar.style.width = `${Math.min(countCompleted * 5, 100)}%`;
            fetchAIQuestion();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        btnStart.addEventListener('click', () => {
            startContainer.classList.add('hidden');
            fetchAIQuestion();
        });
    </script>
</body>
</html>
